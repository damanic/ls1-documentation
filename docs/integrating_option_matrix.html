<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">    
<html xmlns="http://www.w3.org/1999/xhtml" class="mac">
<head>
    <title>LemonStand Version 1 - Integrating Option Matrix</title>
  <link rel="shortcut icon" href="../favicon.ico" />
  <link href="http://feeds.feedburner.com/lemonstand" type="application/rss+xml" rel="alternate" title="LemonStand blog" />
  <link href="http://feeds.feedburner.com/LemonstandReleaseNotes" type="application/rss+xml" rel="alternate" title="LemonStand release notes" />

  <link rel="stylesheet" type="text/css" href="../ls_css_combine/index.html@file[]=%252Fresources%252Fcss%252Fgrid.css&amp;file[]=%252Fresources%252Fcss%252Fformsframework.css&amp;file[]=%252Fresources%252Fcss%252Fscreen.css&amp;file[]=%252Fresources%252Fcss%252Fjquery.fancybox.css&amp;file[]=%252Fresources%252.css"/>

  <script type="text/javascript" src="../ls_javascript_combine/index.html@file[]=%252Fresources%252Fjs%252Fjquery-1.7.1.min.js&amp;file[]=%252Fresources%252Fjs%252Ftwitter.js&amp;file[]=%252Fresources%252Fjs%252Fjquery.noconflict.js&amp;file[]=%252Fmodules%252Fcms%252Fresources%252Fjavascript%252Ff"></script>
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic|Playfair+Display:400,400italic' rel='stylesheet' type='text/css'>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Language" content="en"/>
  <meta name="keywords" content="" />
  <meta name="description" content="" />

  <meta property="fb:app_id" content="194533163908263"/>


   
  <link type="text/css" rel="stylesheet" href="../resources/shl/styles/shCore.css" />
  <link type="text/css" rel="stylesheet" href="../resources/shl/styles/shThemeRDark.css" />  
  <script type="text/javascript" src="../ls_javascript_combine/index.html@file[]=%252Fresources%252Fjs%252Fjquery-ui-1.8.11.custom.min.js&amp;file[]=%252Fresources%252Fshl%252Fscripts%252FshCore.js&amp;file[]=%252Fresources%252Fshl%252Fscripts%252FshBrushJScript.js&amp;file[]=%252Fresources%252Fs"></script>
  
  <script type="text/javascript">
    SyntaxHighlighter.config.clipboardSwf = '/resources/shl/scripts/clipboard.swf';
    SyntaxHighlighter.all();
    SyntaxHighlighter.defaults.gutter = false;
	SyntaxHighlighter.config.strings.expandSource = "Click to expand the code block";
        
    window.addEvent('domready', function() {
      var $ = jQuery;

      $(".thumbnailWrap a").fancybox({      
         'zoomSpeedIn': 300,
         'zoomSpeedOut': 300,
         'overlayShow': true,
         'titleShow'      : 'true',
         'overlayOpacity': .6
       });
       
       jQuery(".code-tabs").tabs();
    });
  </script>  
  <link rel="stylesheet" type="text/css" href="../resources/css/syntax_highlightier.css@1.css" />
  <link rel="stylesheet" type="text/css" href="../resources/css/wiki.css@1.css" />
  
</head>
<body id="b_help" class="mac">
  <div id="wrapper">
    <div id="headerWrapper">
	  	<div style="background:#333;color:#fff;text-align:center;padding:20px 0;">
	  		<p style="color:#eaeaea">This is the documentation for LemonStand V1, which has been discontinued. You can <a href="https://lemonstand.com/v1tocloud">learn more and upgrade your store here</a>.</p>
	  	</div>
       <div id="header">
      <a href="../index.html" id="headerLogo"><img src="../resources/i/lemonstand_logo.png" alt="LemonStand" /></a>      
      	<p id="contactUs"><span data-icon="&#xe04f;" aria-hidden="true"></span> <a href="tel://1-855-332-0555"><strong>1-855-332-0555</strong></a> &nbsp;&nbsp;&nbsp;<span data-icon="&#xe03e;" aria-hidden="true"> <a href="mailto:sales@lemonstand.com"><strong>sales@lemonstand.com</strong></a>&nbsp;&nbsp;&nbsp; 
      			<span data-icon="&#xe016;" aria-hidden="true"></span> <a id="myaccont_login" href="http://v1.lemonstand.com/myaccount/"><strong>Log In</strong></a>
			</p>

      <div id="navigation">
		<ul>
		<!-- <li class="dropdown"><span>Tour &#9662;</span>
			<ul>
				<li class="first"><a href="/tour/">Take a Tour</a></li>
				<li class="last"><a href="/features/customization/">Features</a></li>
			</ul>
		</li> -->
		<!--<li><a href="/features/">Features</a></li>
		<li><a href="/gallery/">Gallery</a></li>-->
		<li><a href="http://v1.lemonstand.com/marketplace/">Marketplace</a></li>
		<!--<li><a href="/buy/">Pricing</a></li>-->
		<li class="dropdown last"><span>Resources &#9662;</span>
			<ul>              
			  <li class="first"><a href="../docs.html">Documentation</a></li>
			  <li><a href="api_function_and_class_reference/index.html">API</a></li>
			  <li id="n_forum"><a href="http://forum.lemonstand.com">Forum</a></li>
			  <li><a href="http://v1.lemonstand.com/myaccount/tickets/">Technical Support</a></li>
			  <li><a href="http://forum.lemonstandapp.com/index.php?app=tracker&showproject=2">Issue Tracker</a></li>
			  <li><a href="http://v1.lemonstand.com/release-notes/">Release Notes</a></li>
			  <!--<li><a href="/faq/">FAQ</a></li>-->
			  <li class="last"><a href="http://blog.lemonstand.com">Blog</a></li>
			</ul>
		</li>
		<li class="dropdown"><span>Partners &#9662;</span>
			<ul>
				<li class="first"><a href="../partners.html">Certified Partners</a></li>
				<li class="last"><a href="../hire-developers/index.html">Hire a Freelancer</a></li>
			</ul>
		
		</li>
        </ul>
      </div><!--/navigation-->      
      
      	    </div><!--/header-->
    </div><!-- /headerWrapper -->    
    <!-- <div id="topContentWrapper">  
      <div id="topContent">
        <div id="topCol1">
          <h1>LemonStand <span>Documentation</span></h1>
        </div>
      </div>
    </div> -->
    <div id="contentWrapper">  
      <div id="content" class="clearfix">
        <div class="wrap12">
	        <form method="get" action="http://v1.lemonstand.com/docs_search">
        <div id="wiki_search">
          <input name="query" type="text" id="wiki_search_field"/>
          <input type="submit" id="btn-doc-search" class="awesome blue large" value="Search"/>
          <div class="wiki_clear"></div>
        </div>
      </form>
    </div>
  
          <div class="col12 wiki_page_content">
        <div class="wiki_breadcrumbs"><ul class="wiki_toc"><li><a href="front_page.html">LemonStand</a></li><li><a href="developer_guide.html">Developer Guide</a></li><li><a href="advanced_features.html">Advanced Features for your Online Store</a></li><li class="last">Integrating Option Matrix</li></ul></div>
        <div id="wiki-cta">
        	<h3>LemonStand Version 1 Has Been Discontinued</h1>
        	<p>This documentation is for LemonStand Version 1. LemonStand is now offered as a cloud-based eCommerce platform.<br> You can try the new LemonStand and <a href="https://lemonstand.com/v1tocloud">learn about upgrading here</a>.</p>
        </div>
        
        <h2>Integrating Option Matrix</h2>
        
        <p>Front-end API for Option Matrix consists of a few functions. Use om() method to access <a href="class_shop_product.html">product</a>, <a href="class_shop_cartitem.html">cart item</a>, or <a href="class_shop_orderitem.html">order item</a> property instead of accessing the property directly. This article explains how to implement Option Matrix support in different areas of a store.</p>
<h3>om() function</h3>
<p><a href="class_shop_product.html">Shop_Product</a>::om() function returns Option Matrix product property with automatic fallback to the base product properties. It uses currently selected product options to determine which Option Matrix product is referred. By default it loads options from POST data, but if the page is first loaded, it should know which options should be used. For example, product options could be specified in the page URL. Use <a href="class_shop_producthelper.html">Shop_ProductHelper</a>::get_default_options() method to obtain selected product options and pass the result as the second parameter of all om() calls on the product page. Example: <div class="codeblock"><pre class="brush:php; collapse: false">$posted_options = Shop_ProductHelper::get_default_options($product);
$price = $product-&gt;om('price', $posted_options);</pre></div></p>
<p>Please read Shop_Product::om() method reference for details.</p>
<h3>Product page</h3>
<p>As product parameters depend on options, product page should be reloaded when another option is selected in the option drop-down menu. That can be accomplished with adding the following onchange event handler to the options SELECT element. If you use the default basic theme, you should update shop:product_options partial. <div class="codeblock"><pre class="brush:php; collapse: false">onchange=&quot;$(this).getForm().sendRequest('on_action', {update: {'product_page': 'product_partial'}})&quot;</pre></div></p>
<h4>Load product images from Option Matrix record, not from the base product</h4>
<p>Use product's om() method to extract Option Matrix images. If you use the base theme, you should update product_partial partial. Update shop:image_slider render partial call: <div class="codeblock"><pre class="brush:php; collapse: false">&lt;? $this-&gt;render_partial('shop:image_slider', array('images'=&gt;$product-&gt;om('images', $posted_options))) ?&gt;</pre></div></p>
<h4>Load inventory information from Option Matrix record</h4>
<p>Use product's om() function to get inventory information. If you use the base theme, you should update product_partial partial. Replace is_out_of_stock(), in_stock and expected_availability_date calls with corresponding om() method calls: <div class="codeblock"><pre class="brush:php; collapse: true">// Replace 
$product-&gt;in_stock;
// with
$product-&gt;om('in_stock', $posted_options);

// Replace
$product-&gt;is_out_of_stock();
// with 
$product-&gt;om('is_out_of_stock', $posted_options);

// Replace
$product-&gt;expected_availability_date;
// with
$product-&gt;om('expected_availability_date', $posted_options)-&gt;format('%x');

// Replace
$product-&gt;allow_pre_order;
// with 
$product-&gt;om('allow_pre_order', $posted_options);</pre></div></p>
<h4>Use Option Matrix to extract the product's sale price and regular price</h4>
<p>Use product's om() function to get pricing information. If you use the base theme, you should update product_partial partial: <div class="codeblock"><pre class="brush:php; collapse: true">// Replace 
$is_discounted = $product-&gt;is_on_sale(); // Previously the method name was is_discounted(), but it is deprecated now
// with
$is_discounted = $product-&gt;om('is_on_sale', $posted_options) 

// Replace
$product-&gt;price();
// with
$product-&gt;om('price', $posted_options);

// Replace
$product-&gt;get_discounted_price(1);
// with
$product-&gt;om('sale_price', $posted_options);</pre></div></p>
<h4>Handle disabled Option Matrix records</h4>
<p>Use om('disabled') to detect whether Option Matrix record is disabled: <div class="codeblock"><pre class="brush:php; collapse: false">&lt;? if (!$product-&gt;om('disabled', $posted_options)): ?&gt;
  Any content placed here will be displayed only if Option Matrix record is not disabled
&lt;? else: ?&gt;
  &lt;p&gt;This product is not available&lt;/p&gt;
&lt;? endif ?&gt;</pre></div></p>
<h3>Product list</h3>
<p>In the product list you should display correct product images and price information.</p>
<h4>Display product image</h4>
<p>Use the product's om() method to extract Option Matrix images: <div class="codeblock"><pre class="brush:php; collapse: false">// Replace
$image_url = $product-&gt;image_url(0, 130, 130);

// with
$images = $product-&gt;om('images');
$image_url = $images-&gt;count ? $images[0]-&gt;getThumbnailPath(130, 130) : null;</pre></div></p>
<h4>Use Option Matrix to extract the product's sale price and regular price</h4>
<p>Use product's om() function to get pricing information: <div class="codeblock"><pre class="brush:php; collapse: true">// Replace
$is_discounted = $product-&gt;is_on_sale(); // Previously the method name was is_discounted(), but it is deprecated now
// with
$is_discounted = $product-&gt;om('is_on_sale');

// Replace
$product-&gt;price();
// with
$product-&gt;om('price');

// Replace
$product-&gt;get_discounted_price(1);
// with
$product-&gt;om('sale_price');
</pre></div></p>
<h4>Output associated product options</h4>
<p>You can output associated product options. The following line outputs product options as string. It is useful on the search results page. If you were selling t-shirts the code would output t-shirt size and color as "Size: M, Color: Yellow" <div class="codeblock"><pre class="brush:php; collapse: false">&lt;?= $product-&gt;options_as_string() ?&gt;</pre></div></p>
<h3>Cart page</h3>
<p>On the cart page correct product images should be displayed in the cart table (shop:cart_table partial in the default theme). Use cart item's om() method to access the product images: <div class="codeblock"><pre class="brush:php; collapse: false">// Replace
$image_url = $item-&gt;product-&gt;image_url(0, 60, 'auto');

// with
$images = $item-&gt;om('images');
$image_url = $images-&gt;count ? $images[0]-&gt;getThumbnailPath(60, 'auto') : null;</pre></div></p>
<h3>Order page</h3>
<p>Use order item's om() method to get product's image: <div class="codeblock"><pre class="brush:php; collapse: false">// Replace
$image_url = $item-&gt;product-&gt;image_url(0, 60, 'auto');

// with
$images = $item-&gt;om('images');
$image_url = $images-&gt;count ? $images[0]-&gt;getThumbnailPath(60, 'auto') : null;</pre></div></p>
<h3>Bundle products</h3>
<p>Use Shop_BundleHelper::get_selected_options() method to detect selected options of a bundle product. This function is similar to Shop_ProductHelper::get_default_options() described above, but it works with bundle products. The result then should be passed as a second argument for bundle item product get_price() call: <div class="codeblock"><pre class="brush:php; collapse: false">// Replace
$item_product-&gt;get_price($product)

// with
$selected_options = Shop_BundleHelper::get_selected_options($item, $item_product);
$item_product-&gt;get_price($product, $selected_options);</pre></div></p>
<p>Changing bundle product option should refresh the bundle product partial. It could be accomplished with adding the onchange event handler to options drop-down menus. If you use Simplicity theme you should update the shop:bundle_product_options partial: <div class="codeblock"><pre class="brush:php; collapse: false">onchange=&quot;$(this).getForm().sendRequest('on_action', {update: {'product_bundle_items': 'shop:bundle'}})&quot;</pre></div></p>
<h4>See also</h4>
<ul>
<li><a href="understanding_option_matrix.html">Understanding Option Matrix</a></li>
</ul>
        
        <p>Next: <a href="creating_the_search_page.html">Creating the Search page</a><br/>Previous: <a href="customer_orders_page.html">How to Display a Customer Order History Page</a><br/>Return to <a href="advanced_features.html">Advanced Features for your Online Store</a></p>
        
              </div>
      
             
          </div><!--/content-->
    </div><!-- /contentWrapper -->
</div><!--/wrapper-->
<div id="footer">
  <div id="footerContent">
    <div class="wrap12">
	    <div class="col4">
	      	<ul>
			<li id="" class="menuHead level1"><span class="title">Learn About The New LemonStand Cloud</span></li><li id="" class="level1"><a href="https://lemonstand.com" title="More information" class="title">More information</a></li><li id="" class="level1"><a href="https://lemonstand.com/showcase" title="LemonStand Showcase" class="title">LemonStand Showcase</a></li><li id="" class="level1"><a href="https://lemonstand.com/features" title="LS Cloud Features" class="title">LS Cloud Features</a></li><li id="" class="level1"><a href="https://lemonstand.com/pricing" title="LS Cloud Pricing" class="title">LS Cloud Pricing</a></li><li id="" class="level1"><a href="https://lemonstand.com/signup" title="LS Cloud Free Trial" class="title">LS Cloud Free Trial</a></li><li id="" class="level1"><a href="http://blog.lemonstand.com" title="eCommerce Blog" class="title">eCommerce Blog</a></li>			</ul>
	    </div>
	    <!--<div class="col2">
	      	<ul>
			<li id="" class="menuHead level1"><span class="title">About V1</span></li><li id="" class="level1"><a href="/gallery-oldurl" title="V1 Customer Gallery" class="title">V1 Customer Gallery</a></li><li id="" class="level1"><a href="/buy" title="Buy V1 License" class="title">Buy V1 License</a></li><li id="" class="level1"><a href="/freetrial" title="V1 Trial License" class="title">V1 Trial License</a></li>			</ul>
	    </div>-->
	    <div class="col2">
	      	<ul>
			<li id="" class="menuHead level1"><span class="title">V1 Community</span></li><li id="" class="level1"><a href="http://v1.lemonstand.com/marketplace" title="Marketplace" class="title">Marketplace</a><ul><li id="" class="level2"><a href="http://v1.lemonstand.com/marketplace/category/modules/" title="V1 Modules" class="title">V1 Modules</a></li><li id="" class="level2"><a href="http://v1.lemonstand.com/marketplace/category/themes/" title="V1 Themes" class="title">V1 Themes</a></li><li id="" class="level2"><a href="http://v1.lemonstand.com/marketplace/ideas/all/" title="V1 Ideas" class="title">V1 Ideas</a></li></ul></li><li id="" class="level1"><a href="../partners.html" title="Partners" class="title">Partners</a></li><li id="" class="level1"><a href="http://forum.lemonstandapp.com/" title="Community Forums" class="title">Community Forums</a></li>			</ul>
	    </div>
	    <div class="col3">
	      	<ul>
			<li id="" class="menuHead level1"><span class="title">V1 Support</span></li><li id="" class="level1"><a href="../myaccount.html" title="My Account" class="title">My Account</a><ul><li id="" class="level2"><a href="http://v1.lemonstand.com/myaccount/tickets" title="V1 Support Tickets" class="title">V1 Support Tickets</a></li></ul></li><li id="" class="level1"><a href="../docs.html" title="Documentation" class="title">Documentation</a><ul><li id="" class="level2"><a href="ecommerce_guide.html" title="V1 Merchant's Guide" class="title">V1 Merchant's Guide</a></li><li id="" class="level2"><a href="developer_s_guide/index.html" title="V1 Developer's Guide" class="title">V1 Developer's Guide</a></li><li id="" class="level2"><a href="../api.html" title="V1 API Docs" class="title">V1 API Docs</a></li></ul></li>			</ul>
	    </div>
	    <!--<div class="col3 share">
	    	<div>
		    	<a href="https://twitter.com/lemonstand" class="twitter-follow-button" data-show-count="false">Follow @lemonstand</a>
		    	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
	    	</div>
	    	
	    	<div>
	    		<iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Ffacebook.com%2Flemonstand&amp;send=false&amp;layout=button_count&amp;width=200&amp;show_faces=false&amp;font=arial&amp;colorscheme=light&amp;action=like&amp;height=21&amp;appId=194533163908263" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:90; height:21px;" allowTransparency="true"></iframe>
	    	</div>
	    	

	    	<div class="g-plusone" data-size="medium" data-href="http://lemonstand.com"></div>
	    	
	    	<div id="footer_newsletter">
	    		<h5>Get Email updates (It's Free)</h5>
	    		<form method="post" action="/" onsubmit="return subscribe_email(this, 'footer_newsletter', 'site:footer:newsletter')">
				    <input type="hidden" name="format" value="h" />
				    <input type="text" name="email" value="Email Address" id="optInEmail" class="formField" />
				    <input type="submit" value="Sign-Up" id="optInBtn" class="button small yellow" />
				    <p>We'll keep your email safe. Promise.</p>
			  </form>
  			</div>
	    </div>-->
    </div>
    <div class="col12 terms">
      <p>Copyright &copy; 2018 LemonStand eCommerce Inc. All Rights Reserved. <a href="../tos/index.html">Terms &amp; Conditions</a> | <a href="../privacy-policy/index.html">Privacy Policy</a></p>
    </div>
  </div><!--/footerContent-->
  <div style="clear: both; width: 960p;">&nbsp;</div>
</div><!--/footer-->



<!-- Place this tag after the last +1 button tag. -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<!-- affiliate -->
<script type="text/javascript"><!--
document.write(unescape("%3Cscript id='pap_x2s6df8d' src='" + (("https:" == document.location.protocol) ? "https://" : "http://") + 
"affiliate.lemonstandapp.com/scripts/trackjs.js' type='text/javascript'%3E%3C/script%3E"));//-->
</script>
<script type="text/javascript"><!--
PostAffTracker.setAccountId('default1');
try {
PostAffTracker.track();
} catch (err) { }
//-->
</script>
<!-- /affiliate -->
<script type="text/javascript">
  // Track GA variables
  var _gaq = _gaq || [];
  
  _gaq.push(['_setCustomVar', 1, 'Visitor Type', 'Guest', 1]);
  _gaq.push(['_setCustomVar', 2, 'Partner', 'No', 1]);
  
  
  _gaq.push(['_setCustomVar', 4, 'Author', 'No', 1]);
</script>

<!--CrazyEgg-->
<script type="text/javascript">
setTimeout(function(){var a=document.createElement("script");
var b=document.getElementsByTagName("script")[0];
a.src=document.location.protocol+"//dnn506yrbagrg.cloudfront.net/pages/scripts/0000/6128.js?"+Math.floor(new Date().getTime()/3600000);
a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
</script>
	<!--AdRoll-->
	<script type="text/javascript">
	adroll_adv_id = "QICDG4SA4BCD7BH2B4E4OA";
	adroll_pix_id = "BZOADVG5ZFG4XATGXBKRV7";
	(function () {
	var oldonload = window.onload;
	window.onload = function(){
	   __adroll_loaded=true;
	   var scr = document.createElement("script");
	   var host = (("https:" == document.location.protocol) ? "https://s.adroll.com" : "http://a.adroll.com");
	   scr.setAttribute('async', 'true');
	   scr.type = "text/javascript";
	   scr.src = host + "/j/roundtrip.js";
	   ((document.getElementsByTagName('head') || [null])[0] ||
	    document.getElementsByTagName('script')[0].parentNode).appendChild(scr);
	   if(oldonload){oldonload()}};
	}());
	</script>
	<!-- Pathful tracking -->
<script>
var PF_APPID = "3b5537e5529b89e5";
setTimeout(function(){ var d = document; 
s = d.createElement('script');
s.type = 'text/javascript'; s.async = true;
s.src = ("https:" == document.location.protocol) ? 
"https://ssl.pathful.com/js/scripts/secure.js"
: "http://s.pathful.com/js/scripts/capture.js";
document.body.appendChild(s, d);
}, 1);
</script>

</body>
 </html>