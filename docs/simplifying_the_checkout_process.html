<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">    
<html xmlns="http://www.w3.org/1999/xhtml" class="mac">
<head>
    <title>LemonStand Version 1 - How to Simplify the Checkout Process</title>
  <link rel="shortcut icon" href="../favicon.ico" />
  <link href="http://feeds.feedburner.com/lemonstand" type="application/rss+xml" rel="alternate" title="LemonStand blog" />
  <link href="http://feeds.feedburner.com/LemonstandReleaseNotes" type="application/rss+xml" rel="alternate" title="LemonStand release notes" />

  <link rel="stylesheet" type="text/css" href="../ls_css_combine/index.html@file[]=%252Fresources%252Fcss%252Fgrid.css&amp;file[]=%252Fresources%252Fcss%252Fformsframework.css&amp;file[]=%252Fresources%252Fcss%252Fscreen.css&amp;file[]=%252Fresources%252Fcss%252Fjquery.fancybox.css&amp;file[]=%252Fresources%252.css"/>

  <script type="text/javascript" src="../ls_javascript_combine/index.html@file[]=%252Fresources%252Fjs%252Fjquery-1.7.1.min.js&amp;file[]=%252Fresources%252Fjs%252Ftwitter.js&amp;file[]=%252Fresources%252Fjs%252Fjquery.noconflict.js&amp;file[]=%252Fmodules%252Fcms%252Fresources%252Fjavascript%252Ff"></script>
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic|Playfair+Display:400,400italic' rel='stylesheet' type='text/css'>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Language" content="en"/>
  <meta name="keywords" content="" />
  <meta name="description" content="" />

  <meta property="fb:app_id" content="194533163908263"/>


   
  <link type="text/css" rel="stylesheet" href="../resources/shl/styles/shCore.css" />
  <link type="text/css" rel="stylesheet" href="../resources/shl/styles/shThemeRDark.css" />  
  <script type="text/javascript" src="../ls_javascript_combine/index.html@file[]=%252Fresources%252Fjs%252Fjquery-ui-1.8.11.custom.min.js&amp;file[]=%252Fresources%252Fshl%252Fscripts%252FshCore.js&amp;file[]=%252Fresources%252Fshl%252Fscripts%252FshBrushJScript.js&amp;file[]=%252Fresources%252Fs"></script>
  
  <script type="text/javascript">
    SyntaxHighlighter.config.clipboardSwf = '/resources/shl/scripts/clipboard.swf';
    SyntaxHighlighter.all();
    SyntaxHighlighter.defaults.gutter = false;
	SyntaxHighlighter.config.strings.expandSource = "Click to expand the code block";
        
    window.addEvent('domready', function() {
      var $ = jQuery;

      $(".thumbnailWrap a").fancybox({      
         'zoomSpeedIn': 300,
         'zoomSpeedOut': 300,
         'overlayShow': true,
         'titleShow'      : 'true',
         'overlayOpacity': .6
       });
       
       jQuery(".code-tabs").tabs();
    });
  </script>  
  <link rel="stylesheet" type="text/css" href="../resources/css/syntax_highlightier.css@1.css" />
  <link rel="stylesheet" type="text/css" href="../resources/css/wiki.css@1.css" />
  
</head>
<body id="b_help" class="mac">
  <div id="wrapper">
    <div id="headerWrapper">
	  	<div style="background:#333;color:#fff;text-align:center;padding:20px 0;">
	  		<p style="color:#eaeaea">This is the documentation for LemonStand V1, which has been discontinued. You can <a href="https://lemonstand.com/v1tocloud">learn more and upgrade your store here</a>.</p>
	  	</div>
       <div id="header">
      <a href="../index.html" id="headerLogo"><img src="../resources/i/lemonstand_logo.png" alt="LemonStand" /></a>      
      	<p id="contactUs"><span data-icon="&#xe04f;" aria-hidden="true"></span> <a href="tel://1-855-332-0555"><strong>1-855-332-0555</strong></a> &nbsp;&nbsp;&nbsp;<span data-icon="&#xe03e;" aria-hidden="true"> <a href="mailto:sales@lemonstand.com"><strong>sales@lemonstand.com</strong></a>&nbsp;&nbsp;&nbsp; 
      			<span data-icon="&#xe016;" aria-hidden="true"></span> <a id="myaccont_login" href="http://v1.lemonstand.com/myaccount/"><strong>Log In</strong></a>
			</p>

      <div id="navigation">
		<ul>
		<!-- <li class="dropdown"><span>Tour &#9662;</span>
			<ul>
				<li class="first"><a href="/tour/">Take a Tour</a></li>
				<li class="last"><a href="/features/customization/">Features</a></li>
			</ul>
		</li> -->
		<!--<li><a href="/features/">Features</a></li>
		<li><a href="/gallery/">Gallery</a></li>-->
		<li><a href="http://v1.lemonstand.com/marketplace/">Marketplace</a></li>
		<!--<li><a href="/buy/">Pricing</a></li>-->
		<li class="dropdown last"><span>Resources &#9662;</span>
			<ul>              
			  <li class="first"><a href="../docs.html">Documentation</a></li>
			  <li><a href="api_function_and_class_reference/index.html">API</a></li>
			  <li id="n_forum"><a href="http://forum.lemonstand.com">Forum</a></li>
			  <li><a href="http://v1.lemonstand.com/myaccount/tickets/">Technical Support</a></li>
			  <li><a href="http://forum.lemonstandapp.com/index.php?app=tracker&showproject=2">Issue Tracker</a></li>
			  <li><a href="http://v1.lemonstand.com/release-notes/">Release Notes</a></li>
			  <!--<li><a href="/faq/">FAQ</a></li>-->
			  <li class="last"><a href="http://blog.lemonstand.com">Blog</a></li>
			</ul>
		</li>
		<li class="dropdown"><span>Partners &#9662;</span>
			<ul>
				<li class="first"><a href="../partners.html">Certified Partners</a></li>
				<li class="last"><a href="../hire-developers/index.html">Hire a Freelancer</a></li>
			</ul>
		
		</li>
        </ul>
      </div><!--/navigation-->      
      
      	    </div><!--/header-->
    </div><!-- /headerWrapper -->    
    <!-- <div id="topContentWrapper">  
      <div id="topContent">
        <div id="topCol1">
          <h1>LemonStand <span>Documentation</span></h1>
        </div>
      </div>
    </div> -->
    <div id="contentWrapper">  
      <div id="content" class="clearfix">
        <div class="wrap12">
	        <form method="get" action="http://v1.lemonstand.com/docs_search">
        <div id="wiki_search">
          <input name="query" type="text" id="wiki_search_field"/>
          <input type="submit" id="btn-doc-search" class="awesome blue large" value="Search"/>
          <div class="wiki_clear"></div>
        </div>
      </form>
    </div>
  
          <div class="col12 wiki_page_content">
        <div class="wiki_breadcrumbs"><ul class="wiki_toc"><li><a href="front_page.html">LemonStand</a></li><li><a href="developer_guide.html">Developer Guide</a></li><li><a href="shop_tips_and_tricks.html">Tips and Tricks</a></li><li class="last">How to Simplify the Checkout Process</li></ul></div>
        <div id="wiki-cta">
        	<h3>LemonStand Version 1 Has Been Discontinued</h1>
        	<p>This documentation is for LemonStand Version 1. LemonStand is now offered as a cloud-based eCommerce platform.<br> You can try the new LemonStand and <a href="https://lemonstand.com/v1tocloud">learn about upgrading here</a>.</p>
        </div>
        
        <h2>How to Simplify the Checkout Process</h2>
        
        <p>The approach described below allows to remove the Payment Method step from the checkout sequence and combine the Pay and Order Review pages, so the payment method selector and payment form are displayed right on the Order Review page. The described approach is compatible with the AJAX-driven <a href="simplifying_the_checkout_process.html#">single-page checkout implementation</a>.</p>
<p>In this article we suppose that you used the demo store template, which is included to the LemonStand installer. If you built your store from scratch, partial and page names may not match names we refer below.</p>
<h3>Step 1. Removing unnecessary steps from the checkout sequence</h3>
<p>To remove the Payment Method and Pay steps from the checkout progress indicator, find the <strong>shop:checkout_progress</strong> partial and comment out the Payment Method and Pay lines in the $steps array. Also you can change the Order Review step name to Review and Pay:</p>
<div class="codeblock"><pre class="brush:php; collapse: false">$steps = array(
  'billing_info' =&gt; 'Billing Information',
  'shipping_info' =&gt; 'Shipping Information',
  'shipping_method' =&gt; 'Shipping Method',
//'payment_method' =&gt; 'Payment Method',
  'review' =&gt; 'Review and Pay',
//'pay' =&gt; 'Pay',
);
</pre></div><h3>Step 2. Creating a default payment method</h3>
<p>LemonStand requires a payment method to be assigned to an order before it can be saved to the database. In this step we will create a default payment method which we will be assigning to all new orders. Customers will be able to choose another payment method on the Review and Pay page.</p>
<p>Go to the Shop/Payment Methods page and click a payment method you would like to make default. Enter the <strong>default</strong> word to the LemonStand API Code field and save the payment method.</p>
<h3>Step 3. Forcing LemonStand to create an order after the Shipping Method step</h3>
<p>LemonStand requires an order to be saved to the database before the visitor can pay it. This means that we need LemonStand to create the order after the Shipping Method step and before redirecting to the Review and Pay page. We can achieve it with a custom AJAX handler. Find the <strong>Checkout</strong> page in the page list (a page which uses the shop:checkout action). Go to AJAX page and paste the following code to the text field:</p>
<div class="codeblock"><pre class="brush:php; collapse: true">function place_order_and_pay($controller, $page, $params)
{
  Shop_CheckoutData::set_payment_method(Shop_PaymentMethod::find_by_api_code('default')-&gt;id);
 
  // Call the default action handler
  $controller-&gt;action();

  // Pretend that we are on the Review checkout step
  // to force LemonStand to place the order
  $_POST['checkout_step'] = 'review';
  $controller-&gt;action();
}
</pre></div><p>Save the page and go to the partials list (CMS/Partials). Find the <strong>shop:checkout_shipping_method</strong> partial and click it. Inside the partial code, find the Next button declaration. The default onclick event handler on this button triggers the on_action server handler. Replace the on_action handler name with the <strong>place_order_and_pay</strong> (this is a name of the AJAX handler we just created on the Checkout page):</p>
<div class="codeblock"><pre class="brush:javascript; collapse: false">&lt;input 
  type=&quot;button&quot; 
  onclick=&quot;return $(this).getForm().sendRequest('place_order_and_pay', 
    {update:{'checkout_page': 'checkout_partial'}})&quot; 
  value=&quot;Place order and pay&quot;/&gt;
</pre></div><h3>Step 4. Updating the Pay page</h3>
<p>The secret of this approach is making the Pay page looking like the Order Review page. To achieve it, you need to display all order details which you usually display on the Order Review page. On the Pay page you have access to the <a href="class_shop_order.html">Shop_Order</a> object (the $order variable). You can use it for loading and displaying the order items, order totals, tax information, etc. You can learn details on these pages: <a href="simplifying_the_checkout_process.html#">Creating the Order Details</a>&nbsp;page and <a href="class_shop_order.html">Shop_Order class</a>.</p>
<p>On the CMS/Pages page find the Pay page. The default Pay page implementation contains some order details information, and the payment form. We are going to leave the order details information (you can extend it), make the payment form updatable and add a payment method selector.</p>
<h4>Making the payment form updatable</h4>
<p>We want the payment form to refresh each time when a customer selects a payment method in the list. To do that, we need to move the payment form code to a partial. Find the following code on the Pay page:</p>
<div class="codeblock"><pre class="brush:php; collapse: true">&lt;? if ($order-&gt;payment_method-&gt;has_payment_form()): ?&gt;
  &lt;div class=&quot;payment_form&quot;&gt;
    &lt;? $payment_method-&gt;render_payment_form($this) ?&gt;
  &lt;/div&gt;
&lt;? else: ?&gt;
  &lt;? if ($message = $payment_method-&gt;pay_offline_message()): ?&gt;
    &lt;p&gt;&lt;?= h($message) ?&gt;&lt;/p&gt;    
  &lt;? else: ?&gt;
    &lt;p&gt;Payment method &quot;&lt;?= h($payment_method-&gt;name) ?&gt;&quot; has no payment form. Please pay and notify us.&lt;/p&gt;    
  &lt;? endif ?&gt;
  &lt;p class=&quot;no_print&quot;&gt;&lt;a href=&quot;/&quot;&gt;&lt;img src=&quot;&lt;?= root_url('/resources/images/btn_continue_shopping.gif') ?&gt;&quot; alt=&quot;Continue shopping&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;? endif ?&gt;
</pre></div><p>Cut it to the clipboard (remove from the Pay page). Go to the CMS/Partials page and create a new partial. Name it <strong>payment_form</strong>. Paste the code from the clipboard and save the partial.</p>
<p>Return to the Pay page. In the place where was the payment form, render the payment form partial with the following code:</p>
<div class="codeblock"><pre class="brush:php; collapse: false">&lt;div id=&quot;payment_form&quot;&gt;
  &lt;? $this-&gt;render_partial('payment_form') ?&gt;
&lt;/div&gt;
</pre></div><h4>Adding the payment method selector</h4>
<p>The last step is adding the payment method selector. The selector will contain a list of applicable payment methods as radio buttons. You can use the following code for creating the list:</p>
<div class="codeblock"><pre class="brush:php; collapse: true">&lt;?= open_form() ?&gt;
  &lt;? $payment_methods = Shop_PaymentMethod::list_applicable(
     $order-&gt;billing_country_id,
     $order-&gt;total) ?&gt;

  &lt;? foreach ($payment_methods as $payment_method): ?&gt;
    &lt;input 
      &lt;?= radio_state($payment_method-&gt;id == $order-&gt;payment_method_id) ?&gt; 
      type=&quot;radio&quot; 
      value=&quot;&lt;?= $payment_method-&gt;id ?&gt;&quot; 
      name=&quot;payment_method&quot; 
      id=&quot;&lt;?= 'payment_method'.$payment_method-&gt;id ?&gt;&quot;
      onclick=&quot;$(this).getForm().sendRequest('shop:on_updatePaymentMethod', {
         update: {'payment_form': 'payment_form'}})&quot;/&gt;

    &lt;label for=&quot;&lt;?= 'payment_method'.$payment_method-&gt;id ?&gt;&quot;&gt;&lt;?= h($payment_method-&gt;name) ?&gt;&lt;/label&gt;&lt;br/&gt;
  &lt;? endforeach ?&gt;
&lt;/form&gt;</pre></div><p>Please note that the onclick handler of the radio buttons triggers the <strong>shop:on_updatePaymentMethod</strong> AJAX server handler. This handler is defined in the Shop module. It assigns a new payment method to the order.</p>
<p><img class="wiki_image_frame_padding" src="../resources/i/wiki/review_and_pay.png" alt="" /></p>
<p>After modifying the Pay page you can style it to match other checkout steps.</p>
        
        <p>Next: <a href="displaying_a_list_of_active_product_discounts.html">Displaying a List of Active Product Catalog Price Rules</a><br/>Previous: <a href="implementing_ship_to_same_billing_address.html">Implementing a Ship to Same Billing Address Feature</a><br/>Return to <a href="shop_tips_and_tricks.html">Tips and Tricks</a></p>
        
              </div>
      
            <div class="wrap12 commentsWrap">
		<div id="thread"></div>
		<div id="disqus_thread"></div>
		<script type="text/javascript">
		var disqus_identifier = "wiki_page_250"; //[Optional but recommended: Define a unique identifier (e.g. post id or slug) for this thread]
		var disqus_url = "http://v1.lemonstand.com/docs/simplifying_the_checkout_process/";
		var disqus_title = "How to Simplify the Checkout Process";
		(function() {
		 var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		 dsq.src = 'http://lemonstand.disqus.com/embed.js';
		 (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=lemonstand">comments powered by Disqus.</a></noscript>

      </div><!--/commentsWrap-->
              
          </div><!--/content-->
    </div><!-- /contentWrapper -->
</div><!--/wrapper-->
<div id="footer">
  <div id="footerContent">
    <div class="wrap12">
	    <div class="col4">
	      	<ul>
			<li id="" class="menuHead level1"><span class="title">Learn About The New LemonStand Cloud</span></li><li id="" class="level1"><a href="https://lemonstand.com" title="More information" class="title">More information</a></li><li id="" class="level1"><a href="https://lemonstand.com/showcase" title="LemonStand Showcase" class="title">LemonStand Showcase</a></li><li id="" class="level1"><a href="https://lemonstand.com/features" title="LS Cloud Features" class="title">LS Cloud Features</a></li><li id="" class="level1"><a href="https://lemonstand.com/pricing" title="LS Cloud Pricing" class="title">LS Cloud Pricing</a></li><li id="" class="level1"><a href="https://lemonstand.com/signup" title="LS Cloud Free Trial" class="title">LS Cloud Free Trial</a></li><li id="" class="level1"><a href="http://blog.lemonstand.com" title="eCommerce Blog" class="title">eCommerce Blog</a></li>			</ul>
	    </div>
	    <!--<div class="col2">
	      	<ul>
			<li id="" class="menuHead level1"><span class="title">About V1</span></li><li id="" class="level1"><a href="/gallery-oldurl" title="V1 Customer Gallery" class="title">V1 Customer Gallery</a></li><li id="" class="level1"><a href="/buy" title="Buy V1 License" class="title">Buy V1 License</a></li><li id="" class="level1"><a href="/freetrial" title="V1 Trial License" class="title">V1 Trial License</a></li>			</ul>
	    </div>-->
	    <div class="col2">
	      	<ul>
			<li id="" class="menuHead level1"><span class="title">V1 Community</span></li><li id="" class="level1"><a href="http://v1.lemonstand.com/marketplace" title="Marketplace" class="title">Marketplace</a><ul><li id="" class="level2"><a href="http://v1.lemonstand.com/marketplace/category/modules/" title="V1 Modules" class="title">V1 Modules</a></li><li id="" class="level2"><a href="http://v1.lemonstand.com/marketplace/category/themes/" title="V1 Themes" class="title">V1 Themes</a></li><li id="" class="level2"><a href="http://v1.lemonstand.com/marketplace/ideas/all/" title="V1 Ideas" class="title">V1 Ideas</a></li></ul></li><li id="" class="level1"><a href="../partners.html" title="Partners" class="title">Partners</a></li><li id="" class="level1"><a href="http://forum.lemonstandapp.com/" title="Community Forums" class="title">Community Forums</a></li>			</ul>
	    </div>
	    <div class="col3">
	      	<ul>
			<li id="" class="menuHead level1"><span class="title">V1 Support</span></li><li id="" class="level1"><a href="../myaccount.html" title="My Account" class="title">My Account</a><ul><li id="" class="level2"><a href="http://v1.lemonstand.com/myaccount/tickets" title="V1 Support Tickets" class="title">V1 Support Tickets</a></li></ul></li><li id="" class="level1"><a href="../docs.html" title="Documentation" class="title">Documentation</a><ul><li id="" class="level2"><a href="ecommerce_guide.html" title="V1 Merchant's Guide" class="title">V1 Merchant's Guide</a></li><li id="" class="level2"><a href="developer_s_guide/index.html" title="V1 Developer's Guide" class="title">V1 Developer's Guide</a></li><li id="" class="level2"><a href="../api.html" title="V1 API Docs" class="title">V1 API Docs</a></li></ul></li>			</ul>
	    </div>
	    <!--<div class="col3 share">
	    	<div>
		    	<a href="https://twitter.com/lemonstand" class="twitter-follow-button" data-show-count="false">Follow @lemonstand</a>
		    	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
	    	</div>
	    	
	    	<div>
	    		<iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Ffacebook.com%2Flemonstand&amp;send=false&amp;layout=button_count&amp;width=200&amp;show_faces=false&amp;font=arial&amp;colorscheme=light&amp;action=like&amp;height=21&amp;appId=194533163908263" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:90; height:21px;" allowTransparency="true"></iframe>
	    	</div>
	    	

	    	<div class="g-plusone" data-size="medium" data-href="http://lemonstand.com"></div>
	    	
	    	<div id="footer_newsletter">
	    		<h5>Get Email updates (It's Free)</h5>
	    		<form method="post" action="/" onsubmit="return subscribe_email(this, 'footer_newsletter', 'site:footer:newsletter')">
				    <input type="hidden" name="format" value="h" />
				    <input type="text" name="email" value="Email Address" id="optInEmail" class="formField" />
				    <input type="submit" value="Sign-Up" id="optInBtn" class="button small yellow" />
				    <p>We'll keep your email safe. Promise.</p>
			  </form>
  			</div>
	    </div>-->
    </div>
    <div class="col12 terms">
      <p>Copyright &copy; 2018 LemonStand eCommerce Inc. All Rights Reserved. <a href="../tos/index.html">Terms &amp; Conditions</a> | <a href="../privacy-policy/index.html">Privacy Policy</a></p>
    </div>
  </div><!--/footerContent-->
  <div style="clear: both; width: 960p;">&nbsp;</div>
</div><!--/footer-->



<!-- Place this tag after the last +1 button tag. -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<!-- affiliate -->
<script type="text/javascript"><!--
document.write(unescape("%3Cscript id='pap_x2s6df8d' src='" + (("https:" == document.location.protocol) ? "https://" : "http://") + 
"affiliate.lemonstandapp.com/scripts/trackjs.js' type='text/javascript'%3E%3C/script%3E"));//-->
</script>
<script type="text/javascript"><!--
PostAffTracker.setAccountId('default1');
try {
PostAffTracker.track();
} catch (err) { }
//-->
</script>
<!-- /affiliate -->
<script type="text/javascript">
  // Track GA variables
  var _gaq = _gaq || [];
  
  _gaq.push(['_setCustomVar', 1, 'Visitor Type', 'Guest', 1]);
  _gaq.push(['_setCustomVar', 2, 'Partner', 'No', 1]);
  
  
  _gaq.push(['_setCustomVar', 4, 'Author', 'No', 1]);
</script>

<!--CrazyEgg-->
<script type="text/javascript">
setTimeout(function(){var a=document.createElement("script");
var b=document.getElementsByTagName("script")[0];
a.src=document.location.protocol+"//dnn506yrbagrg.cloudfront.net/pages/scripts/0000/6128.js?"+Math.floor(new Date().getTime()/3600000);
a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
</script>
	<!--AdRoll-->
	<script type="text/javascript">
	adroll_adv_id = "QICDG4SA4BCD7BH2B4E4OA";
	adroll_pix_id = "BZOADVG5ZFG4XATGXBKRV7";
	(function () {
	var oldonload = window.onload;
	window.onload = function(){
	   __adroll_loaded=true;
	   var scr = document.createElement("script");
	   var host = (("https:" == document.location.protocol) ? "https://s.adroll.com" : "http://a.adroll.com");
	   scr.setAttribute('async', 'true');
	   scr.type = "text/javascript";
	   scr.src = host + "/j/roundtrip.js";
	   ((document.getElementsByTagName('head') || [null])[0] ||
	    document.getElementsByTagName('script')[0].parentNode).appendChild(scr);
	   if(oldonload){oldonload()}};
	}());
	</script>
	<!-- Pathful tracking -->
<script>
var PF_APPID = "3b5537e5529b89e5";
setTimeout(function(){ var d = document; 
s = d.createElement('script');
s.type = 'text/javascript'; s.async = true;
s.src = ("https:" == document.location.protocol) ? 
"https://ssl.pathful.com/js/scripts/secure.js"
: "http://s.pathful.com/js/scripts/capture.js";
document.body.appendChild(s, d);
}, 1);
</script>

</body>
 </html>